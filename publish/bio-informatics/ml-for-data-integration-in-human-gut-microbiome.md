---
title: Machine learning for data integration in human gut microbiome
date: 2022-11-23
tags:
  - microbiome
  - ml
  - bioinformatics
---

> Ref paper.
> 
> https://pubmed.ncbi.nlm.nih.gov/36419034/
> https://microbialcellfactories.biomedcentral.com/articles/10.1186/s12934-022-01973-4

---
#### เนื้อหาหลักของเปเปอร์นี้คือ
การใช้และ integration data / การรวมข้อมูลหลายชนิด (multi-omics integration) multi-omics data เช่น metagenomics, metabolomics, proteomics, genomics and transcriptomics มาช่วยวิเคราะห์

#### Integrative strategies for analysis of multi-omics data using machine learning

การวิเคราะห์ข้อมูล **multi-omics** เช่น metagenomics, metabolomics, proteomics, และ transcriptomics ข้อมูลจากแต่ละประเภทให้มุมมองที่แตกต่างกันเกี่ยวกับระบบชีวภาพ แต่เมื่อนำมารวมกัน ข้อมูลเหล่านี้จะช่วยให้เราเข้าใจความสัมพันธ์ที่ซับซ้อนระหว่างระบบต่างๆ ในร่างกายได้ชัดเจนขึ้น โดยเฉพาะการเชื่อมโยงระหว่าง gut microbiome กับสุขภาพและโรคของมนุษย์

> ทำไมต้องหลายชนิด? การรวมข้อมูลหลายชนิดช่วยให้ ML สามารถทำงานกับข้อมูลที่ซับซ้อนและหลากหลายมากขึ้น ทำให้เราสามารถวิเคราะห์ข้อมูลทางชีวภาพที่ครอบคลุมได้ดีขึ้น โดยเฉพาะอย่างยิ่งการวิเคราะห์ gut microbiome ซึ่งต้องใช้ข้อมูลจากหลายแง่มุมเพื่อทำความเข้าใจบทบาทของ microbiota ในโรคต่างๆ 

โดยในบทความได้กล่าวถึงวิธีการ Integrative ข้อมูล multi-omics ด้วย Machine Learning (ML) ซึ่งแบ่งออกเป็น 3 วิธีหลัก ดังนี้
 
![[Pasted image 20240911213432.png]]

#### 1. The first type of integration strategy combines directly each omics data into one large matrix before training machine learning model (การรวมข้อมูลทั้งหมดเข้าเป็นแมทริกซ์ใหญ่ก่อนการเทรนโมเดล)

วิธีนี้เป็นวิธีการที่รวมข้อมูลจากแต่ละ omics เข้าไปในแมทริกซ์ใหญ่หนึ่งเดียว ซึ่งจากนั้นจะนำไปเทรนในโมเดล ML โดยตรง วิธีนี้ถูกเรียกว่า **data-driven-model** เพราะว่า ML จะทำการวิเคราะห์และค้นหาความสัมพันธ์โดยอัตโนมัติจากข้อมูลดิบที่ได้รับ
#### **ข้อดีของวิธีนี้:**
- การรวมข้อมูลหลายแหล่งช่วยให้โมเดลมีข้อมูลมากขึ้นและสามารถค้นพบความสัมพันธ์ที่ซับซ้อนได้ดีกว่า
- มีการใช้งานง่าย เนื่องจากไม่ต้องทำการแปลงข้อมูลก่อน

>  Zeevi ได้นำข้อมูลหลายมิติ เช่น พารามิเตอร์ในเลือด, พฤติกรรมการกิน, ข้อมูลทางกายภาพ, กิจกรรมทางกาย และข้อมูล microbiota ในลำไส้มารวมกัน และใช้ **Gradient Boosting Regression Model** เพื่อทำนายการตอบสนองของระดับน้ำตาลหลังมื้ออาหารได้อย่างแม่นยำในชีวิตประจำวัน

#### 2. The second type of integrative strategy firstly transform each omics data into an intermediate form (การแปลงข้อมูลเป็นรูปแบบกลางก่อนการรวมกัน)

วิธีนี้จะแปลงข้อมูลจากแต่ละ omics เป็น representation กลาง เช่น การสร้างกราฟหรือ kernel matrix การสร้าง latent variables ผ่านการใช้ **Deep Neural Networks (DNN)** หรือการเรียนรู้ **hidden factors** ก่อนที่จะรวมข้อมูลเหล่านี้เข้าด้วยกันเพื่อนำไปเทรนโมเดล
#### **ข้อดีของวิธีนี้:**
- การแปลงข้อมูลก่อนช่วยลดปัญหาข้อมูลที่มีความซับซ้อนสูง และลดขนาดของข้อมูลให้อยู่ในรูปแบบที่จัดการได้ง่ายขึ้น
- วิธีนี้เหมาะสำหรับการรวมข้อมูลที่มีความแตกต่างกันอย่างมาก เช่น ข้อมูลที่มาจาก genomics และ proteomics

> นักวิจัยใช้ **Deep Neural Network (DNN)** ในการสร้าง latent features จากข้อมูล multi-omics ที่ซับซ้อน จากนั้นนำ representation เหล่านี้มารวมกันเพื่อวิเคราะห์ความเสี่ยงต่อการเกิดโรคมะเร็ง​

> Tsubaki และคณะได้เรียนรู้ representation ของสารประกอบและโปรตีนเป็นรายบุคคล โดยใช้ **Graph Neural Network** สำหรับสารประกอบและ **CNN** สำหรับโปรตีน หลังจากนั้น representation ที่ได้จากทั้งสองถูกนำมารวมกันเพื่อทำนายปฏิสัมพันธ์ระหว่างสารประกอบกับโปรตีน

#### 3. The third type of integrative strategy firstly trains machine learning model separately using each omics data (การรวมผลลัพธ์จากโมเดลแต่ละตัวที่เทรนแยกกัน)

วิธีนี้แต่ละ omics จะถูกนำไปใช้เทรนโมเดลแยกกัน จากนั้นจะรวมผลลัพธ์จากแต่ละโมเดลเข้าด้วยกันเพื่อสร้างผลลัพธ์สุดท้าย เช่น ensemble learning,  Random Forest (RF), Gradient Boosting โดยการรวมโมเดลจากหลายแหล่งข้อมูลจะช่วยเพิ่มความแม่นยำและความเสถียรของผลลัพธ์
#### **ข้อดีของวิธีนี้:**
- การแยกเทรนโมเดลสำหรับข้อมูลแต่ละแหล่งทำให้สามารถจัดการกับความซับซ้อนเฉพาะของแต่ละ omics ได้ดีกว่า

---
### Application of machine learning for analysis of gut microbiome data

![[Pasted image 20240911222810.png]]
https://microbialcellfactories.biomedcentral.com/articles/10.1186/s12934-022-01973-4/tables/1
#### 1. Phenotypic prediction and biomarker discovery (การทำนายฟีโนไทป์และการค้นหา biomarker)

ML ถูกนำมาใช้ในการทำนายสถานะโรคต่างๆ เช่น มะเร็งลำไส้ (Colorectal Cancer; CRC), เบาหวานชนิดที่ 2 (T2D), โรคหลอดเลือดหัวใจ (Cardiovascular Disease; CVD) โดยการใช้ข้อมูล microbiome เพื่อสร้างโมเดลที่สามารถทำนายความเสี่ยงของโรคได้

> ใช้ **Lasso Logistic Regression** และพบกลุ่มจุลินทรีย์สำคัญ เช่น **Fusobacterium species** และ **Peptostreptococcus stomatis** ซึ่งสามารถแยกผู้ป่วยโรคมะเร็งลำไส้ใหญ่ (CRC) (AUC>0.8)
> Yu ใช้  **minimum redundancy–maximum relevance (mRMR)** และค้นพบชุดยีนจุลินทรีย์ที่ดีที่สุด 20 ยีนซึ่งสามารถทำนายสถานะของโรค CRC ได้ จากยีนที่ค้นพบเหล่านี้ มี 4 ยีนที่ผ่านการตรวจสอบและสามารถแยกผู้ป่วย CRC ออกจากกลุ่มควบคุมในกลุ่มชาติพันธุ์ที่แตกต่างกัน (AUC=0.77)

> Midani และคณะ ได้สร้างโมเดล **SVM (Support Vector Machine)** เพื่อทำนายการติดเชื้อ Vibrio cholerae และพบว่าความไวต่อโรคอหิวาต์มีความสัมพันธ์กับการลดลงของสัดส่วนแบคทีเรียในไฟลัม **Bacteroidetes** (AUC=0.8)

ข้อมูล gut microbiome ที่มีมิติสูงและจำนวนตัวอย่างค่อนข้างน้อย (The high dimensionality and relatively low sample sizes of typical gut microbiome data) มักทำให้เกิดปัญหา **curse of dimensionality** เพื่อเปลี่ยนโปรไฟล์ microbiome ที่มีมิติสูงให้อยู่ในรูปแบบที่มีมิติต่ำลง จึงมีการพัฒนา  a deep representation learning framework (**[DeepMicro](https://github.com/minoh0201/DeepMicro)**) 

โดยใช้ **autoencoders** หลายรูปแบบเพื่อบีบอัดคุณลักษณะของจุลินทรีย์ จากนั้นใช้ representation ผลลัพธ์มาในการทำนายโรคต่างๆ ด้วย classification algorithms เช่น **SVM** และ **RF**  (Liver cirrhosis; DeepMicro + SVM, AUC = 0.9)

#### 2. Precision medicine for recommended therapeutics and nutrition (การทำนายผลการรักษาแบบเฉพาะบุคคล)

ความซับซ้อนทางชีวภาพมักทำให้เกิดความแตกต่างระหว่างบุคคลในการตอบสนองต่อการรักษาทางการแพทย์หรือการบริโภคอาหารที่เหมือนกัน ซึ่งชี้ให้เห็นว่าการรักษาแบบทั่วไปอาจมีประสิทธิภาพจำกัดสำหรับโรคบางชนิด เช่น บุคคลมีการตอบสนองต่อระดับน้ำตาลในเลือดหลังอาหารที่แตกต่างกันแม้จะรับประทานอาหารมื้อเดียวกัน

> Zeevi และคณะ ได้ออกแบบโมเดล **Gradient Boosting Regression** เพื่อทำนายการตอบสนองระดับน้ำตาลในเลือดหลังอาหาร (Glucose response) ได้อย่างแม่นยำ โดยอิงจากข้อมูลโภชนาการ, gut microbiome และข้อมูลอื่นๆ โดยใช้โมเดลนี้ การแทรกแซงทางโภชนาการที่ทำนายได้สามารถลดการตอบสนองของระดับน้ำตาลหลังมื้ออาหารลงได้อย่างมีนัยสำคัญ (PCC=~0.7)

> การตอบสนองต่อการรักษาด้วยยากลุ่ม **Infliximab** ในผู้ป่วยที่มีโรคลำไส้อักเสบ (IBD), Zhou และคณะ ได้สร้างโมเดล **Random Forest (RF)** ที่อิงจากโปรไฟล์ของ gut microbiota ซึ่งแสดงผลการทำนาย พบว่าผู้ป่วยที่ตอบสนองต่อการรักษาด้วย Infliximab มีจำนวนจุลินทรีย์กลุ่ม **Clostridiales** เพิ่มขึ้นอย่างมีนัยสำคัญ (Infliximab treatment; RF AUC > 0.86)

> ใช้โมเดล **RF classifier** ที่อิงจากคุณลักษณะของ gut microbiota เพื่อทำนายการตอบสนองต่อการรักษามะเร็งด้วยยาภูมิคุ้มกัน ในผู้ป่วยมะเร็งผิวหนังระยะแพร่กระจาย ผลลัพธ์เหล่านี้บ่งชี้ว่า gut microbiota สามารถใช้เป็น **biomarker** สำหรับประเมินประสิทธิภาพของการรักษาได้ (Immunotherapy; RF AUC = 0.6)

#### 3. Patient stratification and classification of disease subtypes (การแยกประเภทผู้ป่วย)

ML ถูกนำมาใช้เพื่อแยกประเภทผู้ป่วยออกเป็นกลุ่มย่อยๆ ที่มีลักษณะคล้ายกัน เช่น การค้นหา enterotypes ใน gut microbiome ซึ่งสามารถแยก microbiome ของมนุษย์ออกเป็น 2-3 กลุ่มใหญ่ตามการปรากฏของจุลินทรีย์บางชนิด เช่น **Bacteroides**, **Prevotella**, และ **Ruminococcus** โดยอิงจากข้อมูล multi-omics เพราะอาจทำให้ค้นพบชนิดย่อยของโรคที่แท้จริง ซึ่งนำไปสู่การแพทย์เฉพาะบุคคล

---
### Challenges and future perspectives for machine learning in the gut microbiome

### ความท้าทาย

> อย่างไรก็ตาม การประยุกต์ใช้ ML ในการวิเคราะห์ข้อมูล gut microbiome ยังตามหลังสาขาอื่นๆ อยู่พอสมควร

- การจัดการข้อมูลที่มีขนาดใหญ่และซับซ้อนเป็นเรื่องที่ท้าทาย เนื่องจากข้อมูล microbiome มักมีขนาดเล็กเมื่อเทียบกับจำนวนตัวแปรที่มี
- การรวมข้อมูลจากหลายแหล่ง (เช่น ข้อมูลทางพันธุกรรม, อายุ, อาหาร) ยังคงเป็นอุปสรรคต่อการพัฒนาโมเดลที่แม่นยำ
- การพัฒนาเทคนิคใหม่ ๆ เช่น Deep Learning และการสร้างข้อมูลสังเคราะห์ (data augmentation) จะช่วยปรับปรุงความสามารถของโมเดลในอนาคต

1. **ข้อมูลที่มีมิติสูงและมีความหลากหลาย**: ข้อมูล microbiome มักประกอบด้วยคุณลักษณะระดับโมเลกุลที่มีจำนวนมาก (เช่น ยีน, สปีชีส์, สารเมตาบอไลต์) แต่จำนวนตัวอย่างน้อย ทำให้การพัฒนาโมเดลมีประสิทธิภาพเป็นเรื่องยาก นอกจากนี้ยังมีปัญหาการ **overfitting** ซึ่งสามารถป้องกันได้ด้วยการใช้วิธีการต่างๆ เช่น cross-validation, การคัดเลือกฟีเจอร์, ลดความซับซ้อนของโมเดล และการฝึกโมเดลด้วยข้อมูลเพิ่มเติม

   > **เทคนิค deep learning** เช่น autoencoder / deepmicro ถูกนำมาใช้เพื่อลดมิติของข้อมูลเพื่อให้สามารถนำไปใช้ในการวิเคราะห์และทำนายได้อย่างมีประสิทธิภาพมากขึ้น นอกจากนี้ **เทคนิค data augmentation** ที่สร้างข้อมูลสังเคราะห์จากข้อมูลที่มีอยู่สามารถช่วยลดปัญหา overfitting ได้

2. **การรวมข้อมูล multi-omics**: การรวมข้อมูลจากหลายประเภททางชีวภาพ (เช่น genomics, proteomics) ยังคงเป็นความท้าทาย เนื่องจากต้องมีการตีความความสัมพันธ์ทางชีวภาพระหว่างโปรไฟล์โมเลกุลที่แตกต่างกัน แม้จะมีเทคนิค ML ที่ถูกพัฒนาขึ้นสำหรับการวิเคราะห์ข้อมูลแบบบูรณาการเหล่านี้ แต่การสร้างโมเดลที่สามารถจัดการกับตัวแปรที่ซับซ้อนได้ยังคงยาก

   >  **ปัจจัยรบกวน (confounding factors)** เช่น ยา, อายุ, อาหาร สามารถส่งผลต่อความสัมพันธ์ระหว่าง gut microbiota กับโรคเฉพาะ ดังนั้นการบูรณาการปัจจัยเหล่านี้ในโมเดล ML อาจช่วยเพิ่มความแม่นยำในการทำนาย

3. **การศึกษาข้ามประชากร**: โมเดล และ biomarkers ที่พัฒนาขึ้นสำหรับประชากรหนึ่งอาจไม่สามารถนำไปใช้ทั่วไปกับประชากรหรือภูมิภาคอื่นได้ เนื่องจาก microbiota มีความหลากหลายในแต่ละประชากรหรือพื้นที่ ดังนั้นจึงยากที่จะสร้างโมเดลที่ครอบคลุมหลากหลายประชากร

4. **การทดลองในหลายไซต์**: ข้อจำกัดอีกประการหนึ่งคือการมาตรฐานในการใช้ ML ในการทดลองข้ามไซต์ซึ่งมักสร้างข้อมูลชุดที่มีตัวอย่างและตัวแปรที่ไม่สอดคล้องกัน การใช้ **ensemble learning** หรือวิธีการบูรณาการข้อมูลอาจเป็นวิธีแก้ไขที่ดี นอกจากนี้ การจัดการกับชุดข้อมูลที่ไม่สมดุล (imbalanced dataset) ยังเป็นความท้าทายอีกประการหนึ่งในการเพิ่มความแม่นยำในการจำแนกประเภท

5. **การเข้าใจกลไกทางชีวภาพ**: แม้จะมีอัลกอริธึม ML หลายตัวที่พัฒนาเพื่อใช้ในการวิเคราะห์ microbiome แต่การตีความกลไกทางชีวภาพที่อยู่เบื้องหลังการเกิดโรคยังคงเป็นเรื่องยาก
### มุมมองในอนาคต

>  ด้วยปริมาณข้อมูล **metagenomic** ที่เพิ่มขึ้นเรื่อยๆ ML จะสามารถใช้เพื่อระบุยีนจุลินทรีย์และโปรตีนใหม่ๆ จำนวนมากจากสายพันธุ์ที่ยังไม่ถูกเพาะเลี้ยง ซึ่งจะช่วยสร้างความเข้าใจในกลไกของ microbiome

> ML ยังสามารถใช้ในการทำนายโครงสร้างโปรตีนเพื่อการออกแบบเอนไซมหรือพัฒนายาได้ นอกจากนี้ ML สามารถถูกประยุกต์ใช้ในการปรับแต่งอาหารเพื่อสุขภาพให้เหมาะกับแต่ละบุคคล และแนะนำการรักษาที่เหมาะสมสำหรับผู้ป่วย

>  ML สามารถช่วยในการออกแบบ **probiotics** ที่ประกอบด้วยหลายสายพันธุ์ ซึ่งจะช่วยในโภชนาการและการแพทย์เฉพาะบุคคลในอนาคต

> แม้ว่าจะมีความท้าทายมากมาย แต่ความสำเร็จของ AI / ML ที่มาพร้อมกับข้อมูลขนาดใหญ่ได้ปูทางให้กับการประยุกต์ใช้ gut microbiota ซึ่งเป็นโอกาสสำคัญในการพัฒนาแนวทางการรักษาและป้องกันโรคที่มุ่งเน้น microbiota ของมนุษย์

---

บทความนี้มีวัตถุประสงค์เพื่อสำรวจวิธีการประยุกต์ใช้ Machine Learning (ML) ในการวิเคราะห์ข้อมูล microbiome จากลำไส้ของมนุษย์ บทความนี้เน้นการใช้ ML ในการรวมข้อมูลหลายชนิด (multi-omics data) เพื่อค้นหาลักษณะสำคัญที่เกี่ยวข้องกับโรคและพฤติกรรมทางสุขภาพต่าง ๆ

**1.** **บทนำ** **(Introduction)**

- **Gut Microbiota** คือระบบจุลินทรีย์ในลำไส้ที่มีบทบาทสำคัญในการควบคุมการทำงานของร่างกายมนุษย์ รวมถึงการมีผลต่อโรคต่าง ๆ เช่น เบาหวาน, โรคอ้วน, และโรคลำไส้อักเสบ
- **เทคโนโลยี** **High-throughput** ใช้เพื่อสร้างข้อมูล molecular profiling เช่น metagenomics, metatranscriptomics, และ metabolomics ซึ่งช่วยเพิ่มความเข้าใจใน microbiome ของมนุษย์
- การวิเคราะห์ข้อมูลเหล่านี้สามารถทำได้ดีขึ้นด้วยการใช้ ML เพื่อระบุลักษณะสำคัญและสร้างโมเดลที่สามารถทำนายลักษณะทางฟีโนไทป์ (phenotype) ของผู้ป่วยได้แม่นยำขึ้น

**2.** **การเชื่อมโยง** **Microbiome** **กับโรคของมนุษย์**

- ความผิดปกติใน microbiota หรือ dysbiosis เกี่ยวข้องกับโรคต่าง ๆ เช่น โรคหัวใจ, เบาหวาน, โรคมะเร็ง และโรคทางประสาท
- การศึกษาหลายชิ้นแสดงให้เห็นว่าการเปลี่ยนแปลงของ microbiome ส่งผลต่อการเผาผลาญและพฤติกรรมต่าง ๆ ในร่างกาย เช่น ความสมดุลของกรดไขมันสายสั้น (SCFAs), bile acids, และ amino acids

**3. ML** **และการประยุกต์ใช้กับ** **Gut Microbiome**

- ML แบ่งออกเป็น 2 กลุ่มหลักคือ **Supervised Learning** (เรียนรู้จากข้อมูลที่ถูกกำหนดผลลัพธ์) และ **Unsupervised Learning** (ค้นหารูปแบบใหม่ ๆ จากข้อมูลที่ไม่กำหนดผลลัพธ์)
- Supervised Learning ใช้สำหรับสร้างโมเดลที่สามารถทำนายผลลัพธ์ได้ เช่น Random Forest และ Gradient Boosting Decision Trees
- Unsupervised Learning ใช้เพื่อค้นหาลักษณะซ่อนเร้น เช่น การทำ clustering และ dimension reduction
- นอกจากนี้ยังมีการใช้ **Deep Learning** ซึ่งเป็นเครือข่ายประสาทเทียมที่มีหลายชั้น (deep neural network) ในการจัดการกับข้อมูลหลายชนิดที่มีความซับซ้อน

**4.** **การรวมข้อมูลหลายชนิด** **(Multi-omics Integration)**

- มี 3 วิธีหลักในการรวมข้อมูลหลายชนิด:

1. รวมข้อมูลดิบเข้าด้วยกันก่อนการเทรนโมเดล
2. แปลงข้อมูลแต่ละชนิดเป็นรูปแบบกลาง เช่น representation หรือ latent variables
3. สร้างโมเดลแยกกันสำหรับแต่ละชนิดของข้อมูลแล้วรวมผลลัพธ์เข้าด้วยกัน

**5.** **ประยุกต์ใช้** **ML** **ในการวิเคราะห์** **Gut Microbiome**

- ML ถูกนำมาใช้ในการค้นพบ biomarker ที่เกี่ยวข้องกับโรคต่าง ๆ เช่น มะเร็งลำไส้, เบาหวานชนิดที่ 2, โรคหัวใจ และโรคลำไส้อักเสบ
- ML ยังช่วยในการพัฒนาการรักษาแบบเฉพาะบุคคล (personalized medicine) โดยใช้ข้อมูล microbiome เพื่อทำนายการตอบสนองต่อการรักษา เช่น การรักษาด้วยยาหรือการปรับโภชนาการ

  
**6.** **ความท้าทายและมุมมองในอนาคต**

- การจัดการข้อมูลที่มีขนาดใหญ่และซับซ้อนเป็นเรื่องที่ท้าทาย เนื่องจากข้อมูล microbiome มักมีขนาดเล็กเมื่อเทียบกับจำนวนตัวแปรที่มี
- การรวมข้อมูลจากหลายแหล่ง (เช่น ข้อมูลทางพันธุกรรม, อายุ, อาหาร) ยังคงเป็นอุปสรรคต่อการพัฒนาโมเดลที่แม่นยำ
- การพัฒนาเทคนิคใหม่ ๆ เช่น Deep Learning และการสร้างข้อมูลสังเคราะห์ (data augmentation) จะช่วยปรับปรุงความสามารถของโมเดลในอนาคต